<ng-container *ngIf="(store && store.id !== null); else noStore">
    <div class="bg-card w-full relative min-h-screen">

        <ng-container *ngIf="notificationMessage && notificationMessage !== null">
            <div class="bg-primary flex items-center justify-center text-black font-semibold px-4 py-3 w-full relative">
                <div class="flex flex-row items-center justify-center w-full max-w-256">
                    <marquee width="100%" direction="left">
                        {{notificationMessage | uppercase}}
                    </marquee>
                </div>
                <span 
                    (click)="closeNotification()"
                    class="absolute top-0 bottom-0 right-0 px-4 py-2">
                    <mat-icon 
                        class="text-black"
                        [svgIcon]="'heroicons_solid:x'"></mat-icon>
                </span>
            </div>
        </ng-container>

        <!-- Banner -->
        <ng-container *ngIf="isHomePage === true; else normalHeader;">
            <div class="flex flex-col relative items-center w-full h-120 bg-no-repeat bg-cover bg-center overflow-hidden">
        
                <!-- <mat-drawer-container class="flex-auto h-full w-full">
                    <mat-drawer
                        #matDrawer>
                    </mat-drawer>
                    <mat-drawer-content class="flex flex-col w-full bg-red-300 overflow-hidden">
            
                        <div class="lg:hidden flex flex-0 items-center py-2 pl-4 pr-6 sm:py-4 md:pl-6 md:pr-8 border-b lg:border-b-0 bg-card dark:bg-transparent">
                            <button
                                mat-icon-button
                                [routerLink]="['..']">
                                <mat-icon [svgIcon]="'heroicons_outline:arrow-sm-left'"></mat-icon>
                            </button>
                            <h2 class="ml-2.5 text-md sm:text-xl font-medium tracking-tight truncate">
                                {{course.title}}
                            </h2>
                        </div>
        
                        <div
                            class="flex-auto relative overflow-y-auto bg-green-300"
                            cdkScrollable>
        
                            <mat-tab-group
                                class="fuse-mat-no-header"
                                [animationDuration]="'200'"
                                #courseSteps>
                                <ng-container *ngFor="let step of course.steps; trackBy: trackByFn">
                                    <mat-tab>
                                        <ng-template matTabContent>
                                            <div
                                                class="prose prose-sm max-w-3xl mx-auto sm:my-2 lg:mt-4 p-6 sm:p-10 sm:py-12 rounded-2xl shadow overflow-hidden bg-card"
                                                [innerHTML]="step.content"></div>
                                        </ng-template>
                                    </mat-tab>
                                </ng-container>
                            </mat-tab-group>
            
                            <div class="z-10 w-full hidden lg:flex absolute bottom-0 p-4 bg-blue-300">
                                <div class="flex items-center justify-center mx-auto p-2 rounded-full shadow-lg bg-primary">
                                    <button
                                        class="flex-0"
                                        mat-flat-button
                                        [color]="'primary'"
                                        (click)="goToPreviousStep()">
                                        <mat-icon
                                            class="mr-2"
                                            [svgIcon]="'heroicons_outline:arrow-narrow-left'"></mat-icon>
                                        <span class="mr-1">Prev</span>
                                    </button>
                                    <div class="flex items-center justify-center mx-2.5 font-medium leading-5 text-on-primary">
                                        <span>{{currentStep + 1}}</span>
                                        <span class="mx-0.5 text-hint">/</span>
                                        <span>{{course.totalSteps}}</span>
                                    </div>
                                    <button
                                        class="flex-0"
                                        mat-flat-button
                                        [color]="'primary'"
                                        (click)="goToNextStep()">
                                        <span class="ml-1">Next</span>
                                        <mat-icon
                                            class="ml-2"
                                            [svgIcon]="'heroicons_outline:arrow-narrow-right'"></mat-icon>
                                    </button>
                                </div>
                            </div>
            
                        </div>
            
                        <div class="lg:hidden flex items-center p-4 border-t bg-card">
                            <div class="flex items-center justify-center ml-1 lg:ml-2 font-medium leading-5">
                                <span>{{currentStep + 1}}</span>
                                <span class="mx-0.5 text-hint">/</span>
                                <span>{{course.totalSteps}}</span>
                            </div>
                            <mat-progress-bar
                                class="flex-auto ml-6 rounded-full"
                                [value]="100 * (currentStep + 1) / course.totalSteps"></mat-progress-bar>
                            <button
                                class="ml-4"
                                mat-icon-button
                                (click)="goToPreviousStep()">
                                <mat-icon [svgIcon]="'heroicons_outline:arrow-narrow-left'"></mat-icon>
                            </button>
                            <button
                                class="ml-0.5"
                                mat-icon-button
                                (click)="goToNextStep()">
                                <mat-icon [svgIcon]="'heroicons_outline:arrow-narrow-right'"></mat-icon>
                            </button>
                        </div>
            
                    </mat-drawer-content>
                </mat-drawer-container> -->
                
                <!-- Store Banner -->
                <banner-slider></banner-slider>
                
                <!-- Store Description -->
                <div class="flex flex-row justify-center items-center sm:justify-start sm:items-start absolute h-full w-full max-w-256">
                    <div class="w-5/6 sm:w-96 h-full prose prose-sm bg-black bg-opacity-70">
                        <div class="flex flex-col items-center px-10 text-white">
                            <img
                                class="w-40 h-40 my-1.5 rounded-full"
                                [src]="store.storeAsset.logoUrl"
                                alt="Logo image">
                            <div class="w-2/3 border-t border-gray-500"></div>
                            <h1 class="text-white my-6">Welcome !</h1>
                            <p class="text-center">
                                {{ store.storeDescription ? store.storeDescription : "We're so glad you're here! Feels free to browse our store, we've got something special for you. Let's get started!" }}
                            </p>
                        </div>
                    </div>
                    <!-- <div class="absolute bottom-0 left-0 right-0 justify-between w-32 mx-auto pb-2 hidden sm:flex">
                        <button (click)="showSlider(1)" [ngClass]="{'ring-primary': currentSlider.current === 1, 'ring-white': currentSlider.current !== 1}" class="bg-transparent ring rounded-full w-2 mb-4 p-2 " ></button>
                        <button (click)="showSlider(2)" [ngClass]="{'ring-primary': currentSlider.current === 2, 'ring-white': currentSlider.current !== 2}" class="bg-transparent ring rounded-full w-2 mb-4 p-2"></button>
                        <button (click)="showSlider(3)" [ngClass]="{'ring-primary': currentSlider.current === 3, 'ring-white': currentSlider.current !== 3}" class="bg-transparent ring rounded-full w-2 mb-4 p-2"></button>
                        <button (click)="showSlider(4)" [ngClass]="{'ring-primary': currentSlider.current === 4, 'ring-white': currentSlider.current !== 4}" class="bg-transparent ring rounded-full w-2 mb-4 p-2"></button>
                    </div> -->
                </div>
            </div>
        </ng-container>
    
        <!-- Header / Breadcrumb -->
        <ng-template #normalHeader>
            <!-- Header -->
            <div class="flex flex-col items-center w-full h-28 bg-black px-5">
                <div class="flex flex-row justify-between h-full w-full max-w-256">
                    <div class="flex flex-col justify-center text-white">
                        <img
                            class="w-20 h-20 my-1.5 rounded-full cursor-pointer"
                            [routerLink]="'/'"
                            [src]="store.storeAsset.logoUrl"
                            alt="Logo image">
                    </div>
                    <div class="flex flex-col justify-center text-white">
                        <div class="flex flex-row w-auto">
                            <div class="flex flex-col text-right">
                                <p>Call Us!</p>
                                <p>{{ store.phoneNumber}}</p>
                            </div>
                            <div class="relative pl-8">
                                <input
                                    id="shopping-cart-button"
                                    class="absolute h-0 w-0 opacity-0 invisible pointer-events-none"
                                    type="button"
                                    [routerLink]="'/checkout'"
                                    mat-icon-button>
                                <ng-container *ngIf="cartItemQuantity > 0">
                                    <span class="absolute -top-1 -right-1 flex items-center justify-center h-3">
                                        <span class="flex items-center justify-center flex-shrink-0 min-w-4 h-4 px-1 ml-4 mt-2.5 rounded-full bg-white text-black text-xs font-medium">
                                            {{cartItemQuantity}}
                                        </span>
                                    </span>
                                </ng-container>
                                <label 
                                    class="flex items-center justify-center w-10 h-10 rounded-full cursor-pointer bg-primary hover:bg-primary-700"
                                    for="shopping-cart-button"
                                    matRipple>
                                    <mat-icon
                                        class="text-white"
                                        [svgIcon]="'heroicons_solid:shopping-cart'"></mat-icon>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Breadcrumbs -->
            <div class="flex items-center w-full">
                <breadcrumb class="w-full"></breadcrumb>
            </div>
        </ng-template>
    
        <!-- Wrapper -->
        <div class="flex flex-col flex-auto w-full">
            <!-- Content -->
            <div class="flex flex-col flex-auto">
                <!-- *ngIf="true" hack is required here for router-outlet to work correctly.
                     Otherwise, layout changes won't be registered and the view won't be updated! -->
                <router-outlet *ngIf="true"></router-outlet>
            </div>
        </div>

        <!-- Footer Space -->
        <div class="h-48"></div>
        
        <!-- Footer -->
        <div class="absolute inset-x-0 bottom-0 flex flex-col items-center w-full max-h-72 bg-black">
            <div class="flex flex-col h-full items-center w-full max-w-256">
                <div class="flex flex-col w-full items-center px-2 sm:px-10 mb-2 text-white">
                    <!-- <img
                        class="w-20 sm:w-30 sm:h-30 lg:h-40 lg:w-40 h-20  my-1.5 rounded-full"
                        [src]="store.storeAsset.logoUrl"
                        alt="Logo image"> -->
                    <div class="w-full border-t mt-12 border-gray-600"></div>
                    <div class="flex flex-col md:flex-row w-full justify-between">
                        <div class="flex flex-col sm:flex-row md:flex-col w-full md:w-1/2">
                            <div class="flex flex-row items-center justify-between w-full sm:w-1/2 text-md text-white pt-2">
                                <span class="w-1/2 sm:w-auto md:min-w-20 text-gray-400 pr-1">Contact Us:</span>  
                                <span class="w-1/2 flex sm:w-auto flex-auto text-primary-400 items-center justify-end sm:justify-start">
                                    <mat-icon 
                                        class="icon-size-4 text-primary-400"
                                        [svgIcon]="'heroicons_solid:phone'"></mat-icon>
                                    &nbsp;
                                    {{ store.phoneNumber}}
                                </span>
                            </div>
                            <div class="flex flex-row items-center justify-between w-full sm:w-1/2 md:w-full text-md text-white pt-2">
                                <span class="w-1/4 sm:w-auto md:min-w-20 text-gray-400 pr-1">Email:</span>  
                                <span class="w-3/4 md:w-full flex flex-auto text-primary-400 items-center justify-end sm:justify-start">
                                    <mat-icon 
                                        class="icon-size-4 text-primary-400"
                                        [svgIcon]="'mat_solid:email'"></mat-icon>
                                    &nbsp;
                                    {{ store.email}}
                                </span>
                            </div>
                        </div>
                        <div class="flex flex-col flex-wrap w-full md:w-1/2 justify-between">
                            <p class="flex w-full text-sm text-white pt-2">
                                <span class="min-w-20 text-gray-400">Location:</span>  
                                <mat-icon 
                                    class="icon-size-5 text-primary-400"
                                    [svgIcon]="'mat_solid:location_on'"></mat-icon>
                                &nbsp;
                                <span class="flex flex-auto text-primary-400 text-right md:text-left items-end content-end justify-end sm:justify-start">
                                    {{ store.address }} {{ store.city }}, {{ store.postcode }} {{ store.regionCountryStateId }}, {{ store.regionCountry.name }}
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="flex flex-wrap w-full justify-center pt-4">
                        <span class="text-sm font-medium text-secondary text-xs">SYMplified &copy; {{currentYear}} . Version-FNB01-001-{{version}}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-container>

<ng-template #noStore>
    <error-404></error-404>
</ng-template>